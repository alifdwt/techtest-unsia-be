// Code generated by sqlc. DO NOT EDIT.
// versions:
//   sqlc v1.30.0
// source: result.sql

package db

import (
	"context"

	"github.com/jackc/pgx/v5/pgtype"
)

const listAnswersWithQuestions = `-- name: ListAnswersWithQuestions :many
SELECT
  q.id            AS question_id,
  q.question_text,
  q.type,
  q.points,
  a.selected_option_id,
  o.option_text   AS selected_option_text,
  o.is_correct,
  a.essay_answer,
  a.score
FROM answers a
JOIN questions q ON q.id = a.question_id
LEFT JOIN options o ON o.id = a.selected_option_id
WHERE a.attempt_id = $1
ORDER BY q.order_index
`

type ListAnswersWithQuestionsRow struct {
	QuestionID         pgtype.UUID `json:"question_id"`
	QuestionText       string      `json:"question_text"`
	Type               string      `json:"type"`
	Points             int32       `json:"points"`
	SelectedOptionID   pgtype.UUID `json:"selected_option_id"`
	SelectedOptionText pgtype.Text `json:"selected_option_text"`
	IsCorrect          pgtype.Bool `json:"is_correct"`
	EssayAnswer        pgtype.Text `json:"essay_answer"`
	Score              pgtype.Int4 `json:"score"`
}

func (q *Queries) ListAnswersWithQuestions(ctx context.Context, attemptID pgtype.UUID) ([]ListAnswersWithQuestionsRow, error) {
	rows, err := q.db.Query(ctx, listAnswersWithQuestions, attemptID)
	if err != nil {
		return nil, err
	}
	defer rows.Close()
	var items []ListAnswersWithQuestionsRow
	for rows.Next() {
		var i ListAnswersWithQuestionsRow
		if err := rows.Scan(
			&i.QuestionID,
			&i.QuestionText,
			&i.Type,
			&i.Points,
			&i.SelectedOptionID,
			&i.SelectedOptionText,
			&i.IsCorrect,
			&i.EssayAnswer,
			&i.Score,
		); err != nil {
			return nil, err
		}
		items = append(items, i)
	}
	if err := rows.Err(); err != nil {
		return nil, err
	}
	return items, nil
}
